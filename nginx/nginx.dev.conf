worker_processes  auto;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;

events {
	worker_connections  1024;
	use epoll;
	multi_accept on;
}

http {
	upstream dev_sandbox {
		server server:8000;
	}

	server {
		listen 80;
		listen [::]:80;
		server_name dev_sandbox;

		# Handle noisy favicon.ico messages in nginx
		location = /favicon.ico {
			return          204;
			access_log      off;
			log_not_found   off;
		}

		location / {
			proxy_pass "http://dev_sandbox";
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header Host $host;
			proxy_redirect off;
			proxy_set_header X-NginX-Proxy true;
			proxy_send_timeout 1h;
			proxy_read_timeout 1h;
		}

		location /staticfiles/ {
			alias /home/app/web/staticfiles/;
		}
	}
}
